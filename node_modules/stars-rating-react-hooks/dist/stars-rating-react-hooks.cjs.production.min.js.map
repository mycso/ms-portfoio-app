{"version":3,"file":"stars-rating-react-hooks.cjs.production.min.js","sources":["../src/core/useStars.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/component/StarsRating.tsx"],"sourcesContent":["import React, { HtmlHTMLAttributes } from 'react';\nimport { Config, Renderable } from './types';\n\nconst callAllFns = (...fns: any[]) => (...args: any) =>\n  fns.forEach(fn => fn && fn(...args));\n\nexport function useStars(config: Config, isDisabled: boolean = false) {\n  const {\n    totalStars,\n    initialSelectedValue = 0,\n    renderFull,\n    renderHalf = null,\n    renderEmpty,\n  } = config;\n\n  const [selectedValue, setSelectedValue]: [\n    Renderable,\n    React.Dispatch<any>\n  ] = React.useState(initialSelectedValue);\n\n  const [selectingValue, setSelecting]: [\n    Renderable,\n    React.Dispatch<any>\n  ] = React.useState(initialSelectedValue);\n\n  const [isSelecting, setisSelecting]: [\n    boolean,\n    React.Dispatch<any>\n  ] = React.useState(false);\n\n  const onClick = () => {\n    if (isDisabled) return;\n    setSelectedValue(selectingValue);\n  };\n\n  const onMouseEnter = () => {\n    if (isDisabled) return;\n    setisSelecting(true);\n  };\n\n  const onMouseLeave = () => {\n    if (isDisabled) return;\n    setSelecting(selectedValue);\n    setisSelecting(false);\n  };\n\n  const onMouseMove = (e: any, index: number) => {\n    if (isDisabled) return;\n    const rect = e.target.getBoundingClientRect();\n    const xmiddleRelativePosistion = e.pageX - e.target.offsetLeft;\n    if (renderHalf !== null && rect.width / 2 <= xmiddleRelativePosistion) {\n      setSelecting(index + 0.5);\n    } else {\n      setSelecting(index);\n    }\n  };\n\n  const stars: Array<Renderable> = Array.from(\n    Array(totalStars),\n    (_, i: number) => {\n      const shouldRenderHalf = renderHalf !== null ? true : false;\n      let sindex = shouldRenderHalf ? i + 0.5 : i + 1;\n\n      const isSelected = sindex <= selectingValue;\n      const isHalf =\n        !Number.isInteger(selectingValue) && sindex === selectingValue;\n\n      const render = isSelected\n        ? isHalf\n          ? renderHalf\n          : renderFull\n        : renderEmpty;\n\n      return render;\n    }\n  );\n\n  function getStarProps(index: number, elementProps?: any) {\n    const shouldRenderHalf = renderHalf !== null ? true : false;\n    let i = shouldRenderHalf ? index + 0.5 : index + 1;\n    return {\n      ...elementProps,\n      onClick: (e: any) =>\n        callAllFns(\n          onClick(),\n          elementProps && elementProps.onClick(e, selectingValue)\n        ),\n      onMouseMove: (e: any) =>\n        callAllFns(\n          onMouseMove(e, i),\n          elementProps &&\n            elementProps.onMouseMove &&\n            elementProps.onMouseMove(e, i)\n        ),\n    };\n  }\n\n  function getStarWrapperProps(elementProps?: HtmlHTMLAttributes<Element>) {\n    return {\n      ...elementProps,\n      onMouseLeave: callAllFns(\n        elementProps && elementProps.onMouseLeave,\n        onMouseLeave\n      ),\n      onMouseEnter: callAllFns(\n        elementProps && elementProps.onMouseEnter,\n        onMouseEnter\n      ),\n    };\n  }\n\n  return {\n    getStarProps,\n    stars,\n    getStarWrapperProps,\n    isSelecting,\n    selectedValue,\n    selectingValue,\n  };\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import * as React from 'react';\nimport { StarRatingProps } from '../core/types';\nimport { useStars } from '../core/useStars';\nimport styles from './styles/StarRating.module.css';\n\nexport const StarsRating: Function = (props: StarRatingProps) => {\n  const { isDisabled = false } = props;\n  const instance: any = useStars(props.config, isDisabled);\n  const {\n    stars,\n    getStarProps,\n    getStarWrapperProps,\n    isSelecting,\n    selectingValue,\n    selectedValue,\n  } = instance;\n\n  const isMountRef = React.useRef(false);\n\n  React.useEffect(() => {\n    if (props && props.onSelecting && props?.onSelecting) {\n      props.onSelecting(isSelecting, selectingValue);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isSelecting, selectingValue]);\n\n  React.useEffect(() => {\n    if (isMountRef.current === true && props?.onStarsRated) {\n      props.onStarsRated(selectedValue);\n    }\n    isMountRef.current = true;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedValue]);\n\n  return (\n    <>\n      <div>\n        <span tabIndex={0} {...getStarWrapperProps()} className={styles.stars}>\n          {stars?.map((e: any, i: number) => (\n            <span key={i} {...getStarProps(i)} className={styles.star}>\n              {e}\n            </span>\n          ))}\n        </span>\n      </div>\n    </>\n  );\n};\n"],"names":["callAllFns","fns","args","forEach","fn","useStars","config","isDisabled","totalStars","initialSelectedValue","renderFull","renderHalf","renderEmpty","React","useState","selectedValue","setSelectedValue","selectingValue","setSelecting","isSelecting","setisSelecting","onMouseEnter","onMouseLeave","getStarProps","index","elementProps","i","onClick","e","onMouseMove","rect","target","getBoundingClientRect","width","pageX","offsetLeft","stars","Array","from","_","sindex","isSelected","isHalf","Number","isInteger","getStarWrapperProps","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","props","instance","isMountRef","onSelecting","current","onStarsRated","tabIndex","className","map","key"],"mappings":"mWAGA,IAAMA,EAAa,sCAAIC,2BAAAA,yBAAe,sCAAIC,2BAAAA,yBACxCD,EAAIE,SAAQ,SAAAC,UAAMA,GAAMA,eAAMF,iBAEhBG,EAASC,EAAgBC,YAAAA,IAAAA,GAAsB,OAE3DC,EAKEF,EALFE,aAKEF,EAJFG,qBAAAA,aAAuB,IACvBC,EAGEJ,EAHFI,aAGEJ,EAFFK,WAAAA,aAAa,OACbC,EACEN,EADFM,cAMEC,EAAMC,SAASL,GAHZM,OAAeC,SAQlBH,EAAMC,SAASL,GAHZQ,OAAgBC,SAQnBL,EAAMC,UAAS,GAHZK,OAAaC,OAUdC,EAAe,WACfd,GACJa,GAAe,IAGXE,EAAe,WACff,IACJW,EAAaH,GACbK,GAAe,WAoEV,CACLG,sBAnCoBC,EAAeC,OAE/BC,EADoC,OAAff,EACEa,EAAQ,GAAMA,EAAQ,cAE5CC,GACHE,QAAS,SAACC,UACR5B,OApDAO,GACJS,EAAiBC,IAqDXQ,GAAgBA,EAAaE,QAAQC,EAAGX,KAE5CY,YAAa,SAACD,UACZ5B,EA1Cc,SAAC4B,EAAQJ,OACvBjB,OACEuB,EAAOF,EAAEG,OAAOC,wBAGpBd,EADiB,OAAfP,GAAuBmB,EAAKG,MAAQ,GADPL,EAAEM,MAAQN,EAAEG,OAAOI,WAErCX,EAAQ,GAERA,IAoCTK,CAAYD,EAAGF,GACfD,GACEA,EAAaI,aACbJ,EAAaI,YAAYD,EAAGF,QAqBpCU,MAxD+BC,MAAMC,KACrCD,MAAM7B,IACN,SAAC+B,EAAGb,OAEEc,EADoC,OAAf7B,EACOe,EAAI,GAAMA,EAAI,EAExCe,EAAaD,GAAUvB,EACvByB,GACHC,OAAOC,UAAU3B,IAAmBuB,IAAWvB,SAEnCwB,EACXC,EACE/B,EACAD,EACFE,KA2CNiC,6BAjB2BpB,eAEtBA,GACHH,aAActB,EACZyB,GAAgBA,EAAaH,aAC7BA,GAEFD,aAAcrB,EACZyB,GAAgBA,EAAaJ,aAC7BA,MASJF,YAAAA,EACAJ,cAAAA,EACAE,eAAAA,ICrHJ,SAAqB6B,EAAKC,QACX,IAARA,IAAiBA,EAAM,IAC5B,IAAIC,EAAWD,EAAIC,SAEnB,GAAgC,oBAAbC,SAAnB,CAEA,IAAIC,EAAOD,SAASC,MAAQD,SAASE,qBAAqB,QAAQ,GAC9DC,EAAQH,SAASI,cAAc,SACnCD,EAAME,KAAO,WAEI,QAAbN,GACEE,EAAKK,WACPL,EAAKM,aAAaJ,EAAOF,EAAKK,YAKhCL,EAAKO,YAAYL,GAGfA,EAAMM,WACRN,EAAMM,WAAWC,QAAUb,EAE3BM,EAAMK,YAAYR,SAASW,eAAed,iLClBT,SAACe,SACLA,EAAvBtD,WACFuD,EAAgBzD,EAASwD,EAAMvD,sBAEnC8B,EAME0B,EANF1B,MACAb,EAKEuC,EALFvC,aACAsB,EAIEiB,EAJFjB,oBACA1B,EAGE2C,EAHF3C,YACAF,EAEE6C,EAFF7C,eACAF,EACE+C,EADF/C,cAGIgD,EAAalD,UAAa,UAEhCA,aAAgB,WACVgD,GAASA,EAAMG,mBAAeH,GAAAA,EAAOG,aACvCH,EAAMG,YAAY7C,EAAaF,KAGhC,CAACE,EAAaF,IAEjBJ,aAAgB,YACa,IAAvBkD,EAAWE,eAAoBJ,GAAAA,EAAOK,cACxCL,EAAMK,aAAanD,GAErBgD,EAAWE,SAAU,IAEpB,CAAClD,IAGFF,gCACEA,2BACEA,sCAAMsD,SAAU,GAAOtB,KAAuBuB,mDAC3ChC,SAAAA,EAAOiC,KAAI,SAACzC,EAAQF,UACnBb,sCAAMyD,IAAK5C,GAAOH,EAAaG,IAAI0C,4CAChCxC"}